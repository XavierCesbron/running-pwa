<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running App</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#FC4C02">

<style>
body {
    margin:0;
    font-family: Arial, sans-serif;
    background:#111;
    color:white;
}

header {
    background:#FC4C02;
    padding:15px;
    text-align:center;
    font-size:20px;
    font-weight:bold;
}

.tabs {
    display:flex;
    background:#1c1c1c;
}

.tab {
    flex:1;
    padding:12px;
    text-align:center;
    cursor:pointer;
    border-bottom:3px solid transparent;
}

.tab.active {
    border-bottom:3px solid #FC4C02;
    font-weight:bold;
}

.section {
    display:none;
    padding:20px;
}

.section.active {
    display:block;
}

input, button {
    width:100%;
    padding:10px;
    margin:8px 0;
    border:none;
    border-radius:6px;
    font-size:16px;
}

button {
    background:#FC4C02;
    color:white;
    font-weight:bold;
}

.zone-item {
    background:#1e1e1e;
    padding:15px;
    margin:10px 0;
    border-left:6px solid;
    border-radius:6px;
}
</style>
</head>

<body>

<header>üèÉ Running Calculator</header>

<div class="tabs">
    <div class="tab active" onclick="showTab(0)">Conversions</div>
    <div class="tab" onclick="showTab(1)">Allure</div>
    <div class="tab" onclick="showTab(2)">VMA</div>
</div>

<!-- CONVERSIONS -->
<div class="section active">
    <h3>Conversion vitesse ‚Üî allure</h3>
    <input type="number" id="speed" placeholder="Vitesse (km/h)">
    <button onclick="speedToPace()">Convertir en allure</button>
    <div id="res1"></div>
</div>

<!-- ALLURE -->
<div class="section">
    <h3>Calcul temps sur distance</h3>
    <input type="number" id="distance" placeholder="Distance (km)">
    <input type="number" id="paceMin" placeholder="Allure min/km (ex: 5.30)">
    <button onclick="calculateTime()">Calculer temps</button>
    <div id="res2"></div>
</div>

<!-- VMA -->
<div class="section">
    <h3>Zones VMA & pr√©dictions</h3>
    <input type="number" id="vma" placeholder="VMA (km/h)">
    <input type="number" id="fcmax" placeholder="FC max (optionnel)">
    <button onclick="calculZones()">Calculer</button>
    <div id="res3"></div>
</div>

<script>

if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js');
}

function showTab(index){
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
    document.querySelectorAll(".tab")[index].classList.add("active");
    document.querySelectorAll(".section")[index].classList.add("active");
}

function speedToPace(){
    let speed = parseFloat(document.getElementById("speed").value);
    if(!speed) return;
    let paceSec = 3600/speed;
    document.getElementById("res1").innerHTML =
        "Allure : " + secPerKmToAllure(paceSec);
}

function calculateTime(){
    let d = parseFloat(document.getElementById("distance").value);
    let pace = parseFloat(document.getElementById("paceMin").value);
    if(!d || !pace) return;

    let minutes = Math.floor(pace);
    let seconds = Math.round((pace - minutes)*100);

    let totalSec = d*(minutes*60 + seconds);
    document.getElementById("res2").innerHTML =
        "Temps estim√© : " + secToTime(totalSec);
}

function calculZones(){
    let vma = parseFloat(document.getElementById("vma").value);
    let fc = parseFloat(document.getElementById("fcmax").value);
    if(!vma) return;

    const zones = [
        { name:"Marathon", min:75, max:80, fmin:80, fmax:85, c:"#FF9800", d:42.195 },
        { name:"Semi-marathon", min:80, max:85, fmin:85, fmax:90, c:"#FF5722", d:21.097 },
        { name:"10 km", min:85, max:90, fmin:90, fmax:93, c:"#F44336", d:10 },
        { name:"5 km", min:90, max:95, fmin:93, fmax:95, c:"#D32F2F", d:5 }
    ];

    let output="";

    zones.forEach(z=>{
        let sMin = vma*z.min/100;
        let sMax = vma*z.max/100;

        let aMin = 3600/sMin;
        let aMax = 3600/sMax;

        let timeMax = (z.d/sMin)*3600;
        let timeMin = (z.d/sMax)*3600;

        output += `<div class="zone-item" style="border-left-color:${z.c}">
            <strong>${z.name}</strong>
            <p>Vitesse : ${sMin.toFixed(1)} - ${sMax.toFixed(1)} km/h</p>
            <p>Allure : ${secPerKmToAllure(aMin)} - ${secPerKmToAllure(aMax)}</p>`;

        if(fc){
            output += `<p>FC : ${Math.round(fc*z.fmin/100)} - ${Math.round(fc*z.fmax/100)} bpm</p>`;
        }

        output += `<p><strong>Temps estim√© :</strong> ${secToTime(timeMax)} ‚Üí ${secToTime(timeMin)}</p>
        </div>`;
    });

    document.getElementById("res3").innerHTML = output;
}

function secPerKmToAllure(sec){
    let m = Math.floor(sec/60);
    let s = Math.round(sec%60);
    return m + "m" + (s<10?"0":"") + s + "s/km";
}

function secToTime(sec){
    let h = Math.floor(sec/3600);
    let m = Math.floor((sec%3600)/60);
    let s = Math.round(sec%60);
    return h+"h "+m+"m "+s+"s";
}

</script>

</body>
</html>
